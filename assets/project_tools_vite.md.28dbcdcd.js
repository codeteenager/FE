import{_ as l,c as a,o as s,a as e}from"./app.d305f052.js";const b=JSON.parse('{"title":"Vite","description":"","frontmatter":{},"headers":[{"level":2,"title":"ESBuild","slug":"esbuild","link":"#esbuild","children":[{"level":3,"title":"实现原理","slug":"实现原理","link":"#实现原理","children":[]},{"level":3,"title":"使用方式","slug":"使用方式","link":"#使用方式","children":[]},{"level":3,"title":"优缺点","slug":"优缺点","link":"#优缺点","children":[]}]},{"level":2,"title":"SWC","slug":"swc","link":"#swc","children":[{"level":3,"title":"实现原理","slug":"实现原理-1","link":"#实现原理-1","children":[]}]}],"relativePath":"project/tools/vite.md","lastUpdated":1672163032000}'),n={name:"project/tools/vite.md"},i=e(`<h1 id="vite" tabindex="-1">Vite <a class="header-anchor" href="#vite" aria-hidden="true">#</a></h1><p>Vie是vue的作者尤雨溪在开发vue3.0的时候开发的一个web开发构建工具。由于其原生ES模块导入方式，可以实现闪电般的冷服务器启动。Vite是一种新型前端构建工具，能够显著提升前端开发体验。它主要由两部分组成：</p><ul><li>一个开发服务器，它基于 原生 ES 模块 提供了 丰富的内建功能，如速度快到惊人的 模块热更新（HMR）。</li><li>一套构建指令，它使用 Rollup 打包你的代码，并且它是预配置的，可输出用于生产环境的高度优化过的静态资源。</li></ul><p>Vite意在提供开箱即用的配置，同时它的插件API和JavaScript API带来了高度的可扩展性，并有完整的类型支持。</p><h2 id="esbuild" tabindex="-1">ESBuild <a class="header-anchor" href="#esbuild" aria-hidden="true">#</a></h2><p>ESBuild是基于Go语言开发的JavaScript Bundler，它的构建速度是webpack的几十倍。由Figma前CTO Evan Wallace开发，并且也被Vite用于开发环境的依赖解析和Transform。</p><h3 id="实现原理" tabindex="-1">实现原理 <a class="header-anchor" href="#实现原理" aria-hidden="true">#</a></h3><ul><li>由Go实现并编译成本地代码：多数Bundler都是由JavaScript实现的，但是CLI应用对于JIT编译语言来说是性能表现最不好的。每次运行Bundler的时候，JS虚拟机都是以第一次运行代码的视角来解析Bundler(比如Webpack)的代码，没有优化信息。当ESBuild在解析JavaScript的时候，Node还在解析Bundler的JS代码。</li><li>重度使用并行计算：Go语言本身的设计就很重视并行计算，所以ESBuild对这一点会加以利用。在构建中主要由三个环节：解析(Parsing)，链接(Linking)和代码生成(Code generation)。在解析和代码生成环节会尽可能使用多核进行并行计算。</li><li>ESBuild中的一切代码从零实现：通过自行实现所有逻辑来避免第三方库带来的性能问题，统一的数据结构可以减少数据转换开销，并且可以根据需要改变架构，当然最大的缺点就是工作量倍增。</li><li>对内存的高校使用：ESBuild在实现时尽量减少数据的传递以及数据的转换，ESBuild尽量减少对整体AST的传递，并且尽可能复用AST数据，其他的Bundler可能会在编译的不同阶段往复转换数据格式(string-&gt;TS-&gt;JS-&gt;older JS-&gt;string....)，在内存存储效率方面Go也比JavaScript更高效。</li></ul><h3 id="使用方式" tabindex="-1">使用方式 <a class="header-anchor" href="#使用方式" aria-hidden="true">#</a></h3><ol><li>全局安装Esbuild命令，安装完成后可以通过esbuild --version查看版本号</li></ol><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">esbuild</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-g</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li>创建文件，添加测试文件</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//index.js</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">cloneDeep</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lodash</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(cloneDeep)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="3"><li>执行构建命令</li></ol><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">esbuild</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">./index.js</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--bundle</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--outfile=out_esb.js</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--minify</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="4"><li>查看构建后的文件</li></ol><h3 id="优缺点" tabindex="-1">优缺点 <a class="header-anchor" href="#优缺点" aria-hidden="true">#</a></h3><h4 id="优点" tabindex="-1">优点： <a class="header-anchor" href="#优点" aria-hidden="true">#</a></h4><ul><li>Golang开发：采用Go语言开发，可以充分利用多线程打包，并且线程之间共享内容，直接编译成机器码，大大节省了程序运行时间。</li><li>多核并行：得益于Go当中多线程共享内存的优势，内部打包算法充分利用多核CPU优势</li><li>从零造轮子：没有任何第三方库的黑盒逻辑，保证极致的代码性能</li><li>高效利用内存：Esbuild中从头到尾尽可能地复用一份AST节点数据，从而大大提高了内存的利用效率，提升编译性能</li></ul><h4 id="缺点" tabindex="-1">缺点： <a class="header-anchor" href="#缺点" aria-hidden="true">#</a></h4><ul><li>没有TS类型检查</li><li>不能操作AST</li><li>不支持装饰器语法</li><li>产物target无法降级到ES5及以下</li></ul><h2 id="swc" tabindex="-1">SWC <a class="header-anchor" href="#swc" aria-hidden="true">#</a></h2><p>SWC是一个用Rust写的高性能TypeScript/JavaScript转译器，类似于babel。是基于Rust的JavaScript Compiler(其生态中也包含打包工具spack)，目前为NextJS/parcel/Deno等前端圈知名项目使用。</p><h3 id="实现原理-1" tabindex="-1">实现原理 <a class="header-anchor" href="#实现原理-1" aria-hidden="true">#</a></h3><blockquote><p>参考文档：<a href="https://zhuanlan.zhihu.com/p/437529362" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/437529362</a></p></blockquote>`,25),t=[i];function r(o,p,c,d,h,u){return s(),a("div",null,t)}const y=l(n,[["render",r]]);export{b as __pageData,y as default};
